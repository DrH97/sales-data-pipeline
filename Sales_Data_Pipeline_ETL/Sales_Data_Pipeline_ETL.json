{
  "name" : "Sales_Data_Pipeline_ETL",
  "jobMode" : "VISUAL",
  "description" : "",
  "role" : "arn:aws:iam::700297736607:role/SalesDataPipelineRole",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://sales-data-pipeline-s3-bucket/scripts/Sales_Data_Pipeline_ETL.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-762339736633-prod-af-south-1/gs_common.py,s3://aws-glue-studio-transforms-762339736633-prod-af-south-1/gs_null_rows.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-700297736607-af-south-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-observability-metrics" : "true",
    "--enable-glue-datacatalog" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://sales-data-pipeline-s3-bucket/temporary/"
  },
  "connections" : {
    "connections" : [ "Jdbc connection" ]
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 480,
  "maxCapacity" : 10.0,
  "glueVersion" : "5.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "codeGenConfigurationNodes" : "{\"node-1746559271387\":{\"CatalogSource\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Name\":\"RDS - Warehouses\",\"PartitionPredicate\":\"\",\"Table\":\"postgres_public_warehouses\"}},\"node-1746559875659\":{\"Join\":{\"Columns\":[{\"From\":\"node-1746523061951\",\"Keys\":[[\"distributor_sku\"],[\"shell_sku_number\"]]},{\"From\":\"node-1746559845938\",\"Keys\":[[\"distributor_sku\"],[\"shell_sku_number\"]]}],\"Inputs\":[\"node-1746523061951\",\"node-1746559845938\"],\"JoinType\":\"leftanti\",\"Name\":\"New Products\"}},\"node-1746559656258\":{\"Join\":{\"Columns\":[{\"From\":\"node-1746536048230\",\"Keys\":[[\"unit_of_measure\"]]},{\"From\":\"node-1746559628503\",\"Keys\":[[\"unit_of_measure\"]]}],\"Inputs\":[\"node-1746536048230\",\"node-1746559628503\"],\"JoinType\":\"leftanti\",\"Name\":\"New Units of Measure\"}},\"node-1746521618406\":{\"ApplyMapping\":{\"Inputs\":[\"node-1746521003586\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"distributor name\"],\"FromType\":\"string\",\"ToKey\":\"distributor_name\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"dc number\"],\"FromType\":\"string\",\"ToKey\":\"dc_number\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"dc name\"],\"FromType\":\"string\",\"ToKey\":\"dc_name\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"sales month\"],\"FromType\":\"string\",\"ToKey\":\"sales_month\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"sales day\"],\"FromType\":\"string\",\"ToKey\":\"sales_day\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"sales year\"],\"FromType\":\"string\",\"ToKey\":\"sales_year\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"distributor sku\"],\"FromType\":\"string\",\"ToKey\":\"distributor_sku\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"shell sku number\"],\"FromType\":\"string\",\"ToKey\":\"shell_sku_number\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"distributor sku description\"],\"FromType\":\"string\",\"ToKey\":\"description\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"dfoa quantity\"],\"FromType\":\"string\",\"ToKey\":\"dfoa_quantity\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"non-dfoa quantity\"],\"FromType\":\"string\",\"ToKey\":\"non_dfoa_quantity\",\"ToType\":\"int\"},{\"Dropped\":false,\"FromPath\":[\"unit of measure\"],\"FromType\":\"string\",\"ToKey\":\"unit_of_measure\",\"ToType\":\"string\"}],\"Name\":\"Change Schema\"}},\"node-1746523061951\":{\"SparkSQL\":{\"Inputs\":[\"node-1746521434752\"],\"Name\":\"Products - Unique\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"distributor_sku\",\"Type\":\"string\"},{\"Name\":\"shell_sku_number\",\"Type\":\"int\"},{\"Name\":\"description\",\"Type\":\"string\"}]}],\"SqlAliases\":[{\"Alias\":\"sales_data\",\"From\":\"node-1746521434752\"}],\"SqlQuery\":\"select distinct(distributor_sku, shell_sku_number, description) as distributor_sku, distributor_sku, \\nshell_sku_number, description from sales_data\"}},\"node-1746536048230\":{\"SparkSQL\":{\"Inputs\":[\"node-1746521434752\"],\"Name\":\"Unit of Measures - Unique\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"unit_of_measure\",\"Type\":\"string\"}]}],\"SqlAliases\":[{\"Alias\":\"sales_data\",\"From\":\"node-1746521434752\"}],\"SqlQuery\":\"select distinct unit_of_measure from sales_data\"}},\"node-1746538095357\":{\"S3CatalogTarget\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Inputs\":[\"node-1746559656258\"],\"Name\":\"RDS - Unit of Measures\",\"PartitionKeys\":[],\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false},\"Table\":\"postgres_public_units_of_measures\"}},\"node-1746563707337\":{\"CatalogTarget\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Inputs\":[\"node-1746561529408\"],\"Name\":\"RDS - Sales\",\"PartitionKeys\":[],\"Table\":\"postgres_public_sales\"}},\"node-1746521434752\":{\"DynamicTransform\":{\"FunctionName\":\"gs_null_rows\",\"Inputs\":[\"node-1746521618406\"],\"Name\":\"Remove Null Rows\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"distributor_name\",\"Type\":\"string\"},{\"Name\":\"dc_number\",\"Type\":\"int\"},{\"Name\":\"dc_name\",\"Type\":\"string\"},{\"Name\":\"sales_month\",\"Type\":\"int\"},{\"Name\":\"sales_day\",\"Type\":\"int\"},{\"Name\":\"sales_year\",\"Type\":\"int\"},{\"Name\":\"distributor_sku\",\"Type\":\"string\"},{\"Name\":\"shell_sku_number\",\"Type\":\"int\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"dfoa_quantity\",\"Type\":\"int\"},{\"Name\":\"non_dfoa_quantity\",\"Type\":\"int\"},{\"Name\":\"unit_of_measure\",\"Type\":\"string\"}]}],\"Parameters\":[{\"IsOptional\":true,\"Name\":\"extended\",\"Type\":\"bool\",\"Value\":[\"true\"]}],\"Path\":\"s3://aws-glue-studio-transforms-762339736633-prod-af-south-1/gs_null_rows.py\",\"TransformName\":\"gs_null_rows\",\"Version\":\"1.0.0\"}},\"node-1746521003586\":{\"S3CsvSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://sales-data-pipeline-s3-bucket/raw_data/sales_data.csv\"},\"Escaper\":\"\",\"Exclusions\":[],\"Multiline\":false,\"Name\":\"Amazon S3\",\"OptimizePerformance\":false,\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"distributor name\",\"Type\":\"string\"},{\"Name\":\"dc number\",\"Type\":\"string\"},{\"Name\":\"dc name\",\"Type\":\"string\"},{\"Name\":\"sales month\",\"Type\":\"string\"},{\"Name\":\"sales day\",\"Type\":\"string\"},{\"Name\":\"sales year\",\"Type\":\"string\"},{\"Name\":\"distributor sku\",\"Type\":\"string\"},{\"Name\":\"shell sku number\",\"Type\":\"string\"},{\"Name\":\"distributor sku description\",\"Type\":\"string\"},{\"Name\":\"dfoa quantity\",\"Type\":\"string\"},{\"Name\":\"non-dfoa quantity\",\"Type\":\"string\"},{\"Name\":\"unit of measure\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://sales-data-pipeline-s3-bucket/raw_data/sales_data.csv\"],\"QuoteChar\":\"quote\",\"Recurse\":true,\"Separator\":\"comma\",\"WithHeader\":true}},\"node-1746561529408\":{\"SparkSQL\":{\"Inputs\":[\"node-1746521434752\",\"node-1746558730068\",\"node-1746559271387\",\"node-1746559845938\",\"node-1746559628503\"],\"Name\":\"Merged Sales Data\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"distributor_id\",\"Type\":\"int\"},{\"Name\":\"warehouse_id\",\"Type\":\"int\"},{\"Name\":\"product_id\",\"Type\":\"int\"},{\"Name\":\"units_of_measures_id\",\"Type\":\"int\"},{\"Name\":\"sales_date\",\"Type\":\"date\"},{\"Name\":\"sales_day\",\"Type\":\"int\"},{\"Name\":\"sales_month\",\"Type\":\"int\"},{\"Name\":\"sales_year\",\"Type\":\"int\"},{\"Name\":\"dfoa_quantity\",\"Type\":\"int\"},{\"Name\":\"non_dfoa_quantity\",\"Type\":\"int\"}]}],\"SqlAliases\":[{\"Alias\":\"sales_data\",\"From\":\"node-1746521434752\"},{\"Alias\":\"distributors\",\"From\":\"node-1746558730068\"},{\"Alias\":\"warehouses\",\"From\":\"node-1746559271387\"},{\"Alias\":\"products\",\"From\":\"node-1746559845938\"},{\"Alias\":\"unit_of_measures\",\"From\":\"node-1746559628503\"}],\"SqlQuery\":\"SELECT d.id as distributor_id, w.id as warehouse_id, p.id as product_id, u.id as units_of_measures_id, \\nto_date(concat(s.sales_year, lpad(s.sales_month, 2, \\\"0\\\"), s.sales_day), 'yyyyMMdd') as sales_date, \\ns.sales_day, s.sales_month, s.sales_year, s.dfoa_quantity, s.non_dfoa_quantity\\n    FROM sales_data s\\n    JOIN warehouses w\\n    JOIN products p\\n    JOIN unit_of_measures u\\n    JOIN distributors d ON \\n        s.distributor_name = d.distributor_name AND\\n        s.dc_number = w.dc_number AND\\n        s.distributor_sku = p.distributor_sku AND\\n        s.unit_of_measure = u.unit_of_measure\"}},\"node-1746559845938\":{\"CatalogSource\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Name\":\"RDS - Products\",\"PartitionPredicate\":\"\",\"Table\":\"postgres_public_products\"}},\"node-1746559182234\":{\"Join\":{\"Columns\":[{\"From\":\"node-1746522782479\",\"Keys\":[[\"distributor_name\"]]},{\"From\":\"node-1746558730068\",\"Keys\":[[\"distributor_name\"]]}],\"Inputs\":[\"node-1746522782479\",\"node-1746558730068\"],\"JoinType\":\"leftanti\",\"Name\":\"New Distributors\"}},\"node-1746538079865\":{\"S3CatalogTarget\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Inputs\":[\"node-1746559287510\"],\"Name\":\"RDS - Warehouses\",\"PartitionKeys\":[],\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false},\"Table\":\"postgres_public_warehouses\"}},\"node-1746522782479\":{\"SparkSQL\":{\"Inputs\":[\"node-1746521434752\"],\"Name\":\"Distributors - Unique\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"distributor_name\",\"Type\":\"string\"}]}],\"SqlAliases\":[{\"Alias\":\"sales_data\",\"From\":\"node-1746521434752\"}],\"SqlQuery\":\"select distinct(distributor_name) from sales_data\"}},\"node-1746559287510\":{\"Join\":{\"Columns\":[{\"From\":\"node-1746522833097\",\"Keys\":[[\"dc_number\"]]},{\"From\":\"node-1746559271387\",\"Keys\":[[\"dc_number\"]]}],\"Inputs\":[\"node-1746522833097\",\"node-1746559271387\"],\"JoinType\":\"leftanti\",\"Name\":\"New Warehouses\"}},\"node-1746535751008\":{\"S3CatalogTarget\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Inputs\":[\"node-1746559182234\"],\"Name\":\"RDS - Distributors\",\"PartitionKeys\":[],\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false},\"Table\":\"postgres_public_distributors\"}},\"node-1746558730068\":{\"CatalogSource\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Name\":\"RDS - Distributors\",\"PartitionPredicate\":\"\",\"Table\":\"postgres_public_distributors\"}},\"node-1746522833097\":{\"SparkSQL\":{\"Inputs\":[\"node-1746521434752\"],\"Name\":\"Warehouses - Unique\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"dc_number\",\"Type\":\"int\"},{\"Name\":\"dc_name\",\"Type\":\"string\"}]}],\"SqlAliases\":[{\"Alias\":\"sales_data\",\"From\":\"node-1746521434752\"}],\"SqlQuery\":\"select distinct(dc_number), dc_name from sales_data\"}},\"node-1746538048974\":{\"S3CatalogTarget\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Inputs\":[\"node-1746559875659\"],\"Name\":\"RDS - Products\",\"PartitionKeys\":[],\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false},\"Table\":\"postgres_public_products\"}},\"node-1746559628503\":{\"CatalogSource\":{\"Database\":\"sales-data-pipeline-etl-db\",\"Name\":\"RDS - Unit of Measures\",\"PartitionPredicate\":\"\",\"Table\":\"postgres_public_units_of_measures\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "sales-data-pipeline",
    "branch" : "main",
    "folder" : "Sales_Data_Pipeline_ETL"
  }
}